import"./modulepreload-polyfill-3cfb730f.js";import{s as p,c as f,a as h,b,u as y,d as g,e as x}from"./mixin-b670c788.js";let o,u,s,a,i,m;function T(){o=p(),u=f("https://api.openai.com/v1/images/generations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+o},body:{n:1,size:"512x512",response_format:"b64_json"}}),s=document.querySelector(".div_input"),a=document.querySelector(".send_btn"),i=document.querySelector(".list"),m=document.querySelector(".chat_list"),a.addEventListener("click",c),h(s,c)}window.onload=T;function d(e){let t=A(e);return i.appendChild(t),_(),t}function A(e){let t=document.createElement("li"),n=document.createElement("img"),r=document.createElement("div");return n.setAttribute("class","avatar"),e.role=="user"?(t.setAttribute("class","item user"),n.setAttribute("src",y),r.setAttribute("class","text text_user"),r.innerText=e.content):(t.setAttribute("class","item sys"),n.setAttribute("src",g),n.setAttribute("class","avatar"),r.setAttribute("class","text text_sys"),r.innerHTML=`
    <img src="${e.content}" class="draw_res" alt="">
    `),t.append(n,r),t}let _=x(50,()=>{m.scrollTo({top:i.scrollHeight-i.clientHeight,left:0,behavior:"smooth"})}),l=!1;function c(){if(l)return;let e=s.innerText.trim();if(b(e),!v(e)){if(!e){alert("请输入有效内容！");return}l=!0,a.innerText="生成中",d({role:"user",content:e}),s.innerText="",E(e)}}async function E(e){u({prompt:e}).then(t=>t.json()).then(({data:t})=>{let n="data:image/png;base64,"+t[0].b64_json;H(n)}).catch(t=>{console.log("Err",t)}).finally(()=>{l=!1,a.innerText="绘画"})}function H(e){d({role:"sys",content:e})}function v(e){if(e==="clear")return i.innerHTML="",s.innerHTML="",!0}
